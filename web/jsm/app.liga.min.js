var appLiga=angular.module("liga",["angular.filter"]);function ControllerLiga(e,a,n,i){e.profile="",e.tab="",e.sesion={},e.leagues={},e.currentLeague="",e.rankMin=1,e.teamsPerPage=2,e.newLeague={},e.joinLeague={},e.inviteLeague={},e.setCurrentLeague=function(a){e.currentLeague=a},e.setRankMin=function(a){e.rankMin+a<e.currentLeague.cant&&(e.rankMin+=a),e.rankMin<1&&(e.rankMin=1)},e.getLeagues=function(){$.LoadingOverlay("show"),e.leagues={},a.fetchLeagues().then(function(a){e.leagues=a.data.ligas,console.log("imprimo ligas.."),console.log(a),$.LoadingOverlay("hide")},function(e){alert("Error al intentar obtener ligas."),alert(e),$.LoadingOverlay("hide")})},e.leagueTeams={},e.getLeagueTeams=function(){$("#ranking2").LoadingOverlay("show",{fontawesomeResizeFactor:.4}),e.leagueTeams={},n.fetchLeagueTeams(e.currentLeague.id,e.rankMin,e.teamsPerPage).then(function(a){e.leagueTeams=a.data.ligaEquipos,console.log("imprimo equipos de la liga "+e.currentLeague.id),console.log(e.leagueTeams),$("#ranking2").LoadingOverlay("hide")},function(e){alert("Error al intentar obtener equipos."),alert(e),$("#ranking2").LoadingOverlay("hide")})},e.verRanking=function(a,n){console.log("entro a datos de: "+a.id),e.setCurrentLeague(a),e.setRankMin(n),console.log("rankMin: "+e.rankMin+" | teamsPerPage: "+e.teamsPerPage),e.getLeagueTeams(),w3.show("#ranking")},e.ocultarRanking=function(){console.log("cerrado datos de: "+e.currentLeague.id),e.leagueTeams={},e.setCurrentLeague(null),e.rankMin=1,w3.hide("#ranking")},e.enviarLiga=function(a){if(league={},"new-league"===a){if(!$("#leagueName").val())return NeAlert("ERROR","Atencion!","Debe ingresar el nombre de la nueva liga."),!1;league=e.newLeague}else if("join-league"===a){if(!$("#leagueCode").val())return NeAlert("ERROR","Atencion!","Debe ingresar el codigo de la liga."),!1;league=e.joinLeague}else if("invite-league"===a){if(!$("#leagueUser").val())return NeAlert("ERROR","Atencion!","Debe ingresar el usuario a invitar."),!1;e.inviteLeague.nombre=e.currentLeague.id,league=e.inviteLeague}console.log("entro a enviar liga.."),$.LoadingOverlay("show"),i.sendLeague(a,league).then(function(a){console.log("imprimo respuesta.."),console.log(a),w3.hide("#newLeague"),w3.hide("#joinLeague"),w3.hide("#inviteLeague"),e.newLeague={},e.joinLeague={},e.inviteLeague={},NeAlert(a.data.state,"Atencion!",a.data.message),"OK"===a.data.state&&e.getLeagues(),$.LoadingOverlay("hide")},function(e){alert("Error al intentar enviar el registro de liga."),alert(e),$.LoadingOverlay("hide")})},e.getLeagues()}appLiga.controller("ControllerLiga",ControllerLiga),ControllerLiga.$inject=["$scope","leaguesFactory","leagueTeamsFactory","leagueSend"],appLiga.factory("leaguesFactory",["$http",function(e){var a={fetchLeagues:function(){return e.post("GetDatos?ori=datos_ligas",{data:{index:!1,spaces:!1,extraData:[{misLigas:"S"}]}})}};return a}]),appLiga.factory("leagueTeamsFactory",["$http",function(e){var a={fetchLeagueTeams:function(a,n,i){return e.post("GetDatos?ori=datos_liga_equipos",{data:{index:!1,spaces:!1,extraData:[{idLiga:a,rankMin:n,equiPorPag:i}]}})}};return a}]),appLiga.factory("leagueSend",["$http",function(e){var a={sendLeague:function(a,n){return e.post("UpdLeague",{data:{index:!1,spaces:!1,action:a,liga:{torneo:"PRI-APE18",nombre:n.nombre,jornadaInicio:1,codigo:n.codigo,usuario:n.usuario}}})}};return a}]);